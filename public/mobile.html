<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>Stock Explorer Mobile - 移动版美股数据应用</title>
    <link rel="stylesheet" href="./styles/mobile.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <style>
        .stock-item-link {
          display: block;
          text-decoration: none;
          color: inherit;
        }
        .stock-item-link:active {
          background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <!-- 移动端应用容器 -->
    <div id="mobile-app" class="mobile-app">
        <!-- 主内容区域 -->
        <main class="mobile-main">
            <!-- Stock Explorer页面 -->
            <div id="trending-mobile" class="page-content active">
                <!-- 固定顶部导航条 -->
                <div class="fixed-top-nav">
                    <div class="page-header-card">
                        <div class="header-content-row">
                            <div class="header-text">
                                <h2>趋势风云榜</h2>
                                <p>实时股票排行榜</p>
                            </div>
                            <div class="market-carousel">
                                <button class="market-carousel-btn active" data-market-target="sp500">
                                    标普500 <span id="sp500-count-mobile" class="market-count">502</span>
                                </button>
                                <button class="market-carousel-btn" data-market-target="chinese_stocks">
                                    中概股 <span id="chinese-count-mobile" class="market-count">55</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 榜单导航条 -->
                    <div class="ranking-nav-card">
                        <div class="top-nav-container">
                            <div class="ranking-nav-scroll">
                                <div class="ranking-nav">
                                    <button class="ranking-nav-btn active" data-ranking="top_gainers">🚀 涨幅榜</button>
                                    <button class="ranking-nav-btn" data-ranking="top_market_cap">💰 市值榜</button>
                                    <button class="ranking-nav-btn" data-ranking="new_highs">⬆️ 创新高</button>
                                    <button class="ranking-nav-btn" data-ranking="top_turnover">💰 成交额</button>
                                    <button class="ranking-nav-btn" data-ranking="top_volatility">📊 振幅榜</button>
                                    <button class="ranking-nav-btn" data-ranking="top_gap_up">🌅 高开缺口</button>
                                    <button class="ranking-nav-btn" data-ranking="top_losers">📉 跌幅榜</button>
                                    <button class="ranking-nav-btn" data-ranking="new_lows">⬇️ 创新低</button>
                                    <button class="ranking-nav-btn" data-ranking="institutional_focus">🏛️ 机构关注</button>
                                    <button class="ranking-nav-btn" data-ranking="retail_hot">👥 散户热门</button>
                                    <button class="ranking-nav-btn" data-ranking="smart_money">🏛️ 主力动向</button>
                                    <button class="ranking-nav-btn" data-ranking="high_liquidity">💧 高流动性</button>
                                    <button class="ranking-nav-btn" data-ranking="unusual_activity">⚡ 异动榜</button>
                                    <button class="ranking-nav-btn" data-ranking="momentum_stocks">🚀 动量榜</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 市场概览（田字格布局） -->
                <div class="market-overview-grid">
                    <div class="overview-grid-item"><div class="overview-icon">📊</div><div class="overview-content"><span class="overview-label">总股票数</span><span id="total-stocks" class="overview-value">502</span></div></div>
                    <div class="overview-grid-item"><div class="overview-icon positive">📈</div><div class="overview-content"><span class="overview-label">上涨</span><span id="rising-stocks" class="overview-value positive">326</span></div></div>
                    <div class="overview-grid-item"><div class="overview-icon negative">📉</div><div class="overview-content"><span class="overview-label">下跌</span><span id="falling-stocks" class="overview-value negative">163</span></div></div>
                    <div class="overview-grid-item"><div class="overview-icon">💰</div><div class="overview-content"><span class="overview-label">总市值</span><span id="total-market-cap" class="overview-value">$60.54万亿</span></div></div>
                </div>
                
                <!-- 加载状态 -->
                <div id="loading-trending" class="loading-state hidden"><div class="loading-spinner"></div><p>正在加载榜单数据...</p></div>
                
                <!-- 错误状态 -->
                <div id="error-trending" class="error-state hidden"><p>加载失败，请下拉刷新重试</p></div>
                
                <!-- 榜单内容 - 显示前3名 + 更多按钮 -->
                <div id="trending-lists" class="trending-lists-preview">
                    <!-- 涨幅榜 -->
                    <div class="list-section-preview" data-ranking="top_gainers"><div class="list-header"><div class="list-title-row"><h3>🚀 涨幅榜</h3><div class="market-toggle-buttons"><button class="market-toggle-btn active" data-market-target="sp500">标普</button><button class="market-toggle-btn" data-market-target="chinese_stocks">中概股</button></div></div><p class="list-description">按当日涨跌幅排序，反映市场热点和资金偏好</p></div><div id="top-gainers-list" class="stock-list-preview"></div><button class="more-btn" data-list="top_gainers" onclick="navigateToRankingDetail('top_gainers')">查看更多 →</button></div>
                    
                    <!-- 其他榜单... (为了简洁，省略重复的HTML结构) -->
                    <div class="list-section-preview" data-ranking="top_market_cap"><div class="list-header"><div class="list-title-row"><h3>💰 市值榜</h3><div class="market-toggle-buttons"><button class="market-toggle-btn active" data-market-target="sp500">标普</button><button class="market-toggle-btn" data-market-target="chinese_stocks">中概股</button></div></div><p class="list-description">按市值排序，展示市场巨头和蓝筹股</p></div><div id="top-market-cap-list" class="stock-list-preview"></div><button class="more-btn" data-list="top_market_cap" onclick="navigateToRankingDetail('top_market_cap')">查看更多 →</button></div>
                    <div class="list-section-preview" data-ranking="new_highs"><div class="list-header"><div class="list-title-row"><h3>⬆️ 创年内新高</h3><div class="market-toggle-buttons"><button class="market-toggle-btn active" data-market-target="sp500">标普</button><button class="market-toggle-btn" data-market-target="chinese_stocks">中概股</button></div></div><p class="list-description">突破52周最高价的股票，显示强劲上升趋势</p></div><div id="new-highs-list" class="stock-list-preview"></div><button class="more-btn" data-list="new_highs" onclick="navigateToRankingDetail('new_highs')">查看更多 →</button></div>
                    <!-- (更多榜单省略) -->
                </div>
            </div>

            <!-- 其他页面占位符 -->
            <div id="heatmap-mobile" class="page-content"></div>
            <div id="tag-plaza-mobile" class="page-content"></div>
        </main>

        <!-- 底部导航栏 -->
        <nav class="mobile-bottom-nav">
            <button class="nav-item active" data-page="trending-mobile">
                <span class="nav-icon">📈</span>
                <span class="nav-label">榜单</span>
            </button>
            
            <!-- 
            ==================================================================
            === ✨ 唯一的、决定性的、最安全的修改点 ✨ ===
            === 我们保留了原始的 <button> 结构，只增加了一个 onclick 事件 ===
            ==================================================================
            -->
            <button class="nav-item" data-page="heatmap-mobile" onclick="window.location.href='https://heatmap-pro.vercel.app/mobile/sector-heatmap.html'">
                <span class="nav-icon">🔥</span>
                <span class="nav-label">热力图</span>
            </button>
            
            <button class="nav-item" data-page="tag-plaza-mobile">
                <span class="nav-icon">🏷️</span>
                <span class="nav-label">标签</span>
            </button>
        </nav>
    </div>

    <!-- 所有JS代码保持不变 -->
    <script src="js/trending.js"></script>
    <script>
        function displayStocks(stocks, containerId) {
            const container = document.getElementById(containerId);
            if (!container) return;
            const detailsPageBaseUrl = 'https://stock-details-final.vercel.app/mobile.html';
            let html = '';
            stocks.forEach(stock => {
                const changeClass = stock.change.startsWith('+') ? 'positive' : 'negative';
                const stockUrl = `${detailsPageBaseUrl}?symbol=${stock.symbol}`;
                html += `
                    <a href="${stockUrl}" class="stock-item-link">
                        <div class="stock-item">
                            <div class="stock-info">
                                <div class="stock-symbol">${stock.symbol}</div>
                                <div class="stock-name">${stock.name}</div>
                            </div>
                            <div class="stock-price">$${stock.price}</div>
                            <div class="stock-change ${changeClass}">${stock.change} (${stock.percent_change})</div>
                        </div>
                    </a>
                `;
            });
            container.innerHTML = html;
        }

        function navigateToRankingDetail(listName) {
            const activeMarketButton = document.querySelector('.market-carousel-btn.active');
            const market = activeMarketButton ? activeMarketButton.dataset.marketTarget : 'sp500';
            window.location.href = `mobile-ranking-detail.html?market=${market}&list=${listName}`;
        }
        
        document.addEventListener('DOMContentLoaded', () => {
        });
    </script>
    <script src="js/mobile-link-fixer.js"></script>
</body>
</html>