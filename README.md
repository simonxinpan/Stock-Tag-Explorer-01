# Stock-Tag-Explorer - æ™ºèƒ½æ ‡ç­¾æµè§ˆå™¨

> **é¡¹ç›®ä»£å·**: StockLink - Phase 1 Module C: The Neural Network  
> **ç‰ˆæœ¬**: v1.0.1  
> **è´Ÿè´£äºº**: Simon Pan  
> **æœ€åæ›´æ–°**: 2024-12-20

## éƒ¨ç½²çŠ¶æ€
- GitHub Actionsè‡ªåŠ¨éƒ¨ç½²å·²é…ç½® âœ…
- Verceléƒ¨ç½²ç¯å¢ƒå·²å°±ç»ª âœ…  

## ğŸ¯ é¡¹ç›®æ„¿æ™¯

Stock-Tag-Explorer æ˜¯ StockLink å¹³å°"ä¸‰é©¾é©¬è½¦"æˆ˜ç•¥ä¸­çš„æ ¸å¿ƒæ•°æ®å‘ç°å¼•æ“ã€‚å®ƒçš„ä½¿å‘½æ˜¯å°†å­¤ç«‹çš„è‚¡ç¥¨æ•°æ®ï¼Œé€šè¿‡ä¸€ä¸ªæ™ºèƒ½ã€å¤šç»´åº¦çš„æ ‡ç­¾ä½“ç³»ï¼Œè½¬åŒ–ä¸ºä¸€ä¸ªå¯ä¾›æ¢ç´¢çš„ã€å¯Œæœ‰æ´å¯ŸåŠ›çš„"ç¥ç»ç½‘ç»œ"ï¼Œå¸®åŠ©æŠ•èµ„è€…å¿«é€Ÿå‘ç°ç¬¦åˆç‰¹å®šå¸‚åœºç‰¹å¾å’Œè´¢åŠ¡è¡¨ç°çš„è‚¡ç¥¨é›†ç¾¤ã€‚

### æ ¸å¿ƒç›®æ ‡ (v1.0)

- **ç‹¬ç«‹ä¸Šçº¿**: æ‰“é€ ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€å¯ç‹¬ç«‹è®¿é—®çš„"æ ‡ç­¾å¹¿åœº"Web åº”ç”¨
- **æ•°æ®é©±åŠ¨**: åº”ç”¨çš„å…¨éƒ¨å†…å®¹éœ€ç”±åç«¯çš„ Neon æ•°æ®åº“åŠ¨æ€é©±åŠ¨
- **å»ºç«‹è¿æ¥**: ä¸º StockLink å¹³å°çš„å…¶ä»–æ¨¡å—ï¼ˆçƒ­åŠ›å›¾ã€ä¸ªè‚¡è¯¦æƒ…é¡µï¼‰æä¾›æ•°æ®æ¥å£å’Œå¯¼èˆªé“¾æ¥

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯å±•ç¤ºå±‚     â”‚    â”‚    APIæœåŠ¡å±‚      â”‚    â”‚   æ•°æ®å­˜å‚¨å±‚     â”‚
â”‚                â”‚    â”‚                  â”‚    â”‚                â”‚
â”‚ â€¢ æ ‡ç­¾å¹¿åœº      â”‚â—„â”€â”€â–ºâ”‚ â€¢ /api/tags      â”‚â—„â”€â”€â–ºâ”‚ â€¢ Neon Database â”‚
â”‚ â€¢ è‚¡ç¥¨åˆ—è¡¨      â”‚    â”‚ â€¢ /api/update    â”‚    â”‚ â€¢ stocksè¡¨      â”‚
â”‚ â€¢ äº¤äº’ç•Œé¢      â”‚    â”‚ â€¢ é”™è¯¯å¤„ç†       â”‚    â”‚ â€¢ tagsè¡¨        â”‚
â”‚                â”‚    â”‚                  â”‚    â”‚ â€¢ stock_tagsè¡¨  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                      â”‚                      â”‚
           â”‚                      â”‚                      â”‚
           â–¼                      â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¤–éƒ¨é›†æˆ      â”‚    â”‚   è‡ªåŠ¨åŒ–ä»»åŠ¡      â”‚    â”‚   æ•°æ®æº        â”‚
â”‚                â”‚    â”‚                  â”‚    â”‚                â”‚
â”‚ â€¢ è¯¦æƒ…é¡µè·³è½¬    â”‚    â”‚ â€¢ GitHub Actions â”‚    â”‚ â€¢ Polygon.io    â”‚
â”‚ â€¢ çƒ­åŠ›å›¾è¿æ¥    â”‚    â”‚ â€¢ å®šæ—¶æ›´æ–°       â”‚    â”‚ â€¢ Finnhub       â”‚
â”‚                â”‚    â”‚ â€¢ CRONä»»åŠ¡       â”‚    â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ åŠŸèƒ½éœ€æ±‚

### 2.1 æ ¸å¿ƒé¡µé¢ï¼šæ ‡ç­¾å¹¿åœº (Tag Plaza)

**åŠŸèƒ½æè¿°**:
- é¡µé¢åŠ è½½æ—¶ï¼Œä»åç«¯ API (`/api/tags`) è·å–æ‰€æœ‰å·²å®šä¹‰çš„ã€ä¸”æœ‰å…³è”è‚¡ç¥¨çš„æ ‡ç­¾
- æ ‡ç­¾æŒ‰ç±»å‹è¿›è¡Œè§†è§‰åˆ†ç»„å±•ç¤ºï¼š
  - **é™æ€æ ‡ç­¾**: è¡Œä¸šåˆ†ç±»ã€ç‰¹æ®Šåå• (å¦‚æ ‡æ™®500)
  - **åŠ¨æ€æ ‡ç­¾**: è‚¡å¸‚è¡¨ç°ã€è´¢åŠ¡è¡¨ç°ã€è¶‹åŠ¿æ’ä½
- æ¯ä¸ªæ ‡ç­¾å±•ç¤ºæ ‡ç­¾åç§°å’Œæ‹¥æœ‰è¯¥æ ‡ç­¾çš„è‚¡ç¥¨æ•°é‡
- å®Œå–„çš„åŠ è½½çŠ¶æ€å’Œé”™è¯¯çŠ¶æ€å¤„ç†

### 2.2 æ ¸å¿ƒäº¤äº’ï¼šæ ‡ç­¾ç­›é€‰ä¸å±•ç¤º

**åŠŸèƒ½æè¿°**:
- æ‰€æœ‰æ ‡ç­¾éƒ½å¯ç‚¹å‡»
- ç‚¹å‡»æ ‡ç­¾åï¼š
  - é¡µé¢ä¸‹æ–¹å±•ç¤ºè‚¡ç¥¨åˆ—è¡¨
  - è°ƒç”¨åç«¯ API (`/api/tags?tag_name=æ ‡ç­¾å`) è·å–ç›¸å…³è‚¡ç¥¨
  - åˆ—è¡¨å±•ç¤ºï¼šä¸­æ–‡åç§°ã€è‚¡ç¥¨ä»£ç  (Ticker)ã€å®æ—¶æ¶¨è·Œå¹…
  - æ¯åªè‚¡ç¥¨å¯ç‚¹å‡»è·³è½¬åˆ°è¯¦æƒ…é¡µï¼š`https://stock-details-final.vercel.app/?symbol=[TICKER]`

## ğŸ”§ æŠ€æœ¯è§„èŒƒ

### åç«¯ API è®¾è®¡

#### `/api/tags` - æ•°æ®è¯»å–å™¨

**æ— å‚æ•°è°ƒç”¨**:
```json
GET /api/tags

Response:
{
  "success": true,
  "data": [
    {
      "tag_name": "é«˜ROE",
      "tag_type": "è´¢åŠ¡è¡¨ç°",
      "stock_count": 45,
      "description": "ROE > 15%çš„è‚¡ç¥¨"
    }
  ]
}
```

**å¸¦tag_nameå‚æ•°**:
```json
GET /api/tags?tag_name=é«˜ROE

Response:
{
  "success": true,
  "tag_name": "é«˜ROE",
  "data": [
    {
      "ticker": "AAPL",
      "name_zh": "è‹¹æœå…¬å¸",
      "change_percent": 2.34,
      "current_price": 150.25
    }
  ]
}
```

#### `/api/update-data` - åå°æ•°æ®å·¥äºº

**åŠŸèƒ½**:
- ä» Polygon.io å’Œ Finnhub è·å–æœ€æ–°æ•°æ®
- æ›´æ–° stocks è¡¨çš„å¸‚åœºæ•°æ®å’Œè´¢åŠ¡æŒ‡æ ‡
- æ ¹æ®é¢„è®¾è§„åˆ™è®¡ç®—å¹¶åº”ç”¨åŠ¨æ€æ ‡ç­¾
- æ›´æ–° stock_tags è¡¨

### æ•°æ®åº“è®¾è®¡

#### stocks è¡¨
```sql
CREATE TABLE stocks (
  id SERIAL PRIMARY KEY,
  ticker VARCHAR(10) UNIQUE NOT NULL,
  name_en VARCHAR(255),
  name_zh VARCHAR(255),
  current_price DECIMAL(10,2),
  change_percent DECIMAL(5,2),
  volume BIGINT,
  market_cap BIGINT,
  pe_ratio DECIMAL(8,2),
  roe DECIMAL(5,2),
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### tags è¡¨
```sql
CREATE TABLE tags (
  id SERIAL PRIMARY KEY,
  tag_name VARCHAR(100) UNIQUE NOT NULL,
  tag_type VARCHAR(50),
  description TEXT,
  is_dynamic BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### stock_tags è¡¨
```sql
CREATE TABLE stock_tags (
  id SERIAL PRIMARY KEY,
  stock_id INTEGER REFERENCES stocks(id),
  tag_id INTEGER REFERENCES tags(id),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE(stock_id, tag_id)
);
```

## ğŸš€ å¼€å‘é‡Œç¨‹ç¢‘

### M1 - åç«¯å°±ç»ª
- [ ] å®Œæˆæ•°æ®åº“è®¾è®¡å’Œåˆå§‹åŒ–
- [ ] å®ç° `/api/tags` æ¥å£
- [ ] å®ç° `/api/update-data` æ¥å£
- [ ] é…ç½® Neon æ•°æ®åº“è¿æ¥
- [ ] é›†æˆ Polygon.io å’Œ Finnhub API
- [ ] æµ‹è¯•æ•°æ®æ³¨å…¥å’Œæ ‡ç­¾ç”Ÿæˆ

### M2 - å‰ç«¯ä¸Šçº¿
- [ ] åˆ›å»ºæ ‡ç­¾å¹¿åœºé¡µé¢
- [ ] å®ç°æ ‡ç­¾å±•ç¤ºå’Œåˆ†ç»„
- [ ] å®ç°æ ‡ç­¾ç‚¹å‡»å’Œè‚¡ç¥¨åˆ—è¡¨å±•ç¤º
- [ ] æ·»åŠ åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†
- [ ] å®ç°è·³è½¬åˆ°è¯¦æƒ…é¡µåŠŸèƒ½
- [ ] å“åº”å¼è®¾è®¡ä¼˜åŒ–

### M3 - v1.0 å‘å¸ƒ
- [ ] é…ç½® GitHub Actions è‡ªåŠ¨åŒ–ä»»åŠ¡
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] éƒ¨ç½²åˆ° Vercel
- [ ] æ­£å¼ä¸Šçº¿ tag-explorer.vercel.app

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **é¡µé¢åŠ è½½æ—¶é—´**: < 3ç§’
- **API å“åº”æ—¶é—´**: < 500æ¯«ç§’
- **æ•°æ®æ›´æ–°é¢‘ç‡**: æ¯æ—¥è‡ªåŠ¨æ›´æ–°
- **é”™è¯¯ç‡**: < 1%

## ğŸ”’ å®‰å…¨è¦æ±‚

- æ‰€æœ‰ API å¯†é’¥é€šè¿‡ Vercel ç¯å¢ƒå˜é‡ç®¡ç†
- åå°æ›´æ–°ä»»åŠ¡é€šè¿‡ CRON_SECRET ä¿æŠ¤
- æ•°æ®åº“è¿æ¥ä½¿ç”¨å®‰å…¨è¿æ¥å­—ç¬¦ä¸²
- å‰ç«¯è¾“å…¥éªŒè¯å’Œ XSS é˜²æŠ¤

## ğŸ”— ç›¸å…³é“¾æ¥

- [Stock Details Final](https://stock-details-final.vercel.app/)
- [Polygon.io API æ–‡æ¡£](https://polygon.io/docs)
- [Finnhub API æ–‡æ¡£](https://finnhub.io/docs/api)
- [Neon æ•°æ®åº“æ–‡æ¡£](https://neon.tech/docs)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æœ¬åœ°å¼€å‘

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/your-username/Stock-Tag-Explorer.git
   cd Stock-Tag-Explorer
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

3. **é…ç½®ç¯å¢ƒå˜é‡**
   ```bash
   cp .env.example .env
   # ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„APIå¯†é’¥å’Œæ•°æ®åº“è¿æ¥
   ```

4. **æ£€æŸ¥ç¯å¢ƒé…ç½®**
   ```bash
   npm run check-env
   ```

5. **æµ‹è¯•APIè¿æ¥**
   ```bash
   npm run test:api
   ```

6. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm run dev
   ```

7. **è®¿é—®åº”ç”¨**
   æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3000`

### éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

1. **é…ç½®Vercelç¯å¢ƒå˜é‡**
   - åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
     - `DATABASE_URL`: Neonæ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
     - `POLYGON_API_KEY`: Polygon.io APIå¯†é’¥
     - `FINNHUB_API_KEY`: Finnhub APIå¯†é’¥
     - `CRON_SECRET`: CRONä»»åŠ¡ä¿æŠ¤å¯†é’¥

2. **éƒ¨ç½²åº”ç”¨**
   ```bash
   vercel --prod
   ```

3. **éªŒè¯éƒ¨ç½²**
    - è®¿é—®éƒ¨ç½²çš„URL
    - æ£€æŸ¥APIç«¯ç‚¹æ˜¯å¦æ­£å¸¸å·¥ä½œ
    - éªŒè¯æ•°æ®æ›´æ–°ä»»åŠ¡æ˜¯å¦æ­£å¸¸æ‰§è¡Œ

### GitHub Actions è‡ªåŠ¨åŒ–

æœ¬é¡¹ç›®é…ç½®äº†å®Œæ•´çš„CI/CDæµç¨‹ï¼š

1. **é…ç½®GitHub Secrets**
   ```
   POLYGON_API_KEY     # Polygon.io APIå¯†é’¥
   FINNHUB_API_KEY     # Finnhub APIå¯†é’¥
   DATABASE_URL        # Neonæ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
   VERCEL_TOKEN        # Verceléƒ¨ç½²ä»¤ç‰Œï¼ˆå¯é€‰ï¼‰
   ORG_ID             # Vercelç»„ç»‡IDï¼ˆå¯é€‰ï¼‰
   PROJECT_ID         # Vercelé¡¹ç›®IDï¼ˆå¯é€‰ï¼‰
   ```

2. **è‡ªåŠ¨éƒ¨ç½²å·¥ä½œæµ**
   - æ¨é€åˆ°mainåˆ†æ”¯æ—¶è‡ªåŠ¨è§¦å‘
   - è¿è¡Œç¯å¢ƒæ£€æŸ¥å’ŒAPIæµ‹è¯•
   - è‡ªåŠ¨éƒ¨ç½²åˆ°Vercelç”Ÿäº§ç¯å¢ƒ

3. **æ•°æ®æ›´æ–°å·¥ä½œæµ**
   - æ¯ä¸ªå·¥ä½œæ—¥ç¾ä¸œæ—¶é—´8:00 AMè‡ªåŠ¨è¿è¡Œ
   - æ”¯æŒæ‰‹åŠ¨è§¦å‘
   - è‡ªåŠ¨æ›´æ–°è‚¡ç¥¨æ•°æ®å¹¶éªŒè¯ç»“æœ

4. **ç›‘æ§å’Œè°ƒè¯•**
   ```bash
   # æœ¬åœ°æµ‹è¯•ç¯å¢ƒé…ç½®
   npm run check-env
   
   # æµ‹è¯•APIè¿æ¥
   npm run test:api
   
   # æ‰‹åŠ¨æ›´æ–°è‚¡ç¥¨æ•°æ®
   npm run update-stocks
   
   # éªŒè¯æ•°æ®æ›´æ–°
   npm run verify-data
   ```

è¯¦ç»†é…ç½®è¯´æ˜è¯·å‚è€ƒ [GitHub Actionsé…ç½®æŒ‡å—](./GITHUB_ACTIONS_SETUP.md)

---

**æ³¨**: æœ¬æ–‡æ¡£å°†éšç€é¡¹ç›®è¿›å±•æŒç»­æ›´æ–°ï¼Œè¯·å…³æ³¨ç‰ˆæœ¬å˜æ›´ã€‚