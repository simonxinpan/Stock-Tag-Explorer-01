<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Tag Explorer - Êô∫ËÉΩÊ†áÁ≠æÊµèËßàÂô®</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ÂÖ®Â±ÄÊ†∑ÂºèÈáçÁΩÆ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Ê†πÂèòÈáèÂÆö‰πâ */
        :root {
            --primary-color: #2563eb;
            --primary-hover: #1d4ed8;
            --secondary-color: #64748b;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --background-color: #f8fafc;
            --surface-color: #ffffff;
            --border-color: #e2e8f0;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
        }

        /* Âü∫Á°ÄÊ†∑Âºè */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 14px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Â∑•ÂÖ∑Á±ª */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        /* Â§¥ÈÉ®Ê†∑Âºè */
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #3b82f6 100%);
            color: white;
            padding: 2rem 0;
            box-shadow: var(--shadow-md);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .header-left {
            flex: 1;
        }

        .logo {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .header-right {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 1rem;
        }

        .nav-links {
            display: flex;
            gap: 1rem;
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .nav-link:hover {
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
        }

        .nav-link.active {
            color: white;
            background-color: rgba(255, 255, 255, 0.2);
            font-weight: 600;
        }

        /* ÂÆûÊó∂Êó∂Èó¥ÊòæÁ§∫ */
        .time-display {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .local-time {
            margin-bottom: 0.25rem;
        }

        .et-time {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* ‰∏ªÂÜÖÂÆπÂå∫ */
        .main {
            padding: 2rem 0;
            min-height: calc(100vh - 200px);
        }

        /* Ê†áÁ≠æÂπøÂú∫ */
        .tag-plaza {
            margin-bottom: 2rem;
        }

        .tag-plaza h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        /* Âä†ËΩΩÂíåÈîôËØØÁä∂ÊÄÅ */
        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .error {
            text-align: center;
            padding: 2rem;
            color: var(--danger-color);
            background-color: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: var(--radius-md);
            margin: 1rem 0;
        }

        /* Ê†áÁ≠æÁªÑ */
        .tag-groups {
            display: grid;
            gap: 2rem;
        }

        .tag-group {
            background: var(--surface-color);
            border-radius: var(--radius-xl);
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .tag-group:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .tag-group h3 {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tag-group.performance h3::before {
            content: 'üìà';
        }

        .tag-group.financial h3::before {
            content: 'üí∞';
        }

        .tag-group.trend h3::before {
            content: 'üî•';
        }

        .tag-group.industry h3::before {
            content: 'üè≠';
        }

        .tag-group.special h3::before {
            content: '‚≠ê';
        }

        .tag-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .tag-card {
            background: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .tag-card:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .tag-card h4 {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .tag-card p {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 0.5rem;
        }

        .tag-card .stock-count {
            font-size: 0.8rem;
            font-weight: 500;
            opacity: 0.7;
        }

        /* ËÇ°Á•®ÂàóË°® */
        .stock-list-section {
            margin-top: 2rem;
        }

        .stock-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .stock-list-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .stock-list-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .sort-select {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--surface-color);
            color: var(--text-primary);
            font-size: 0.9rem;
            cursor: pointer;
        }

        .clear-btn {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .clear-btn:hover {
            background: #dc2626;
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .stock-list {
            display: grid;
            gap: 1rem;
        }

        .stock-item {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }

        .stock-item:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        .stock-info {
            flex: 1;
        }

        .stock-symbol {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1.1rem;
        }

        .stock-name {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 0.25rem;
        }

        .stock-metrics {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .stock-price {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1.1rem;
        }

        .stock-change {
            font-weight: 500;
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
        }

        .stock-change.positive {
            background: #dcfce7;
            color: var(--success-color);
        }

        .stock-change.negative {
            background: #fef2f2;
            color: var(--danger-color);
        }

        .stock-change.neutral {
            background: var(--background-color);
            color: var(--text-secondary);
        }

        /* ÂàÜÈ°µ */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 2rem;
        }

        .pagination button {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pagination button:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .pagination button.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* È°µËÑö */
        .footer {
            background: var(--surface-color);
            border-top: 1px solid var(--border-color);
            padding: 1.5rem 0;
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Toast ÈÄöÁü• */
        .toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--surface-color);
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
            z-index: 1001;
            transition: all 0.3s ease;
        }

        .toast.success {
            background: var(--success-color);
            color: white;
        }

        .toast.error {
            background: var(--danger-color);
            color: white;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .header-right {
                align-items: center;
            }
            
            .stock-list-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .stock-list-controls {
                justify-content: center;
            }
            
            .stock-item {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
            }
            
            .stock-metrics {
                justify-content: space-between;
            }
            
            .tag-cards {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }

        @media (max-width: 480px) {
            .nav-links {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .tag-cards {
                grid-template-columns: 1fr;
            }
            
            .stock-metrics {
                flex-direction: column;
                gap: 0.5rem;
            }
        }

        /* Âä†ËΩΩÂä®Áîª */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .loading {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Â§¥ÈÉ® -->
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <div class="header-left">
                        <h1 class="logo">üìä Stock Tag Explorer</h1>
                        <p class="subtitle">Êô∫ËÉΩÊ†áÁ≠æÊµèËßàÂô® - ÂèëÁé∞ÊäïËµÑÊú∫‰ºö</p>
                    </div>
                    <div class="header-right">
                        <nav class="nav-links">
                            <a href="#" class="nav-link active">Ê†áÁ≠æÂπøÂú∫</a>
                            <a href="https://stock-tag-explorer-01-i7tdnaego-simon-pans-projects.vercel.app/trending.html" class="nav-link" target="_blank">Ë∂ãÂäøÊ¶úÂçï</a>
                        </nav>
                        <div class="time-display">
                            <div class="local-time" id="local-time">--</div>
                            <div class="et-time" id="et-time">Áæé‰∏úÊó∂Èó¥: --</div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- ‰∏ªÂÜÖÂÆπÂå∫ -->
        <main class="main">
            <div class="container">
                <!-- Ê†áÁ≠æÂπøÂú∫ -->
                <section id="tag-plaza" class="tag-plaza">
                    <h2>Ê†áÁ≠æÂπøÂú∫</h2>
                    <div id="loading" class="loading">Âä†ËΩΩ‰∏≠...</div>
                    <div id="error" class="error hidden">Âä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞ÈáçËØï</div>
                    <div id="tag-groups" class="tag-groups hidden"></div>
                </section>
                
                <!-- ËÇ°Á•®ÂàóË°® -->
                <section id="stock-list-section" class="stock-list-section hidden">
                    <div class="stock-list-header">
                        <h3 id="stock-list-title">ÈÄâ‰∏≠Ê†áÁ≠æÁöÑËÇ°Á•®</h3>
                        <div class="stock-list-controls">
                            <select id="sort-select" class="sort-select">
                                <option value="name-asc">ÊåâÂêçÁß∞ÊéíÂ∫è ‚Üë</option>
                                <option value="name-desc">ÊåâÂêçÁß∞ÊéíÂ∫è ‚Üì</option>
                                <option value="price-desc">Êåâ‰ª∑Ê†ºÊéíÂ∫è ‚Üì</option>
                                <option value="price-asc">Êåâ‰ª∑Ê†ºÊéíÂ∫è ‚Üë</option>
                                <option value="change-desc">ÊåâÊ∂®Ë∑åÂπÖÊéíÂ∫è ‚Üì</option>
                                <option value="change-asc">ÊåâÊ∂®Ë∑åÂπÖÊéíÂ∫è ‚Üë</option>
                                <option value="volume-desc">ÊåâÊàê‰∫§ÈáèÊéíÂ∫è ‚Üì</option>
                                <option value="volume-asc">ÊåâÊàê‰∫§ÈáèÊéíÂ∫è ‚Üë</option>
                            </select>
                            <button id="clear-selection" class="clear-btn">Ê∏ÖÈô§ÈÄâÊã©</button>
                        </div>
                    </div>
                    <div id="stock-list" class="stock-list"></div>
                    <div id="pagination" class="pagination hidden"></div>
                </section>
            </div>
        </main>
        
        <!-- È°µËÑö -->
        <footer class="footer">
            <div class="container">
                <p>&copy; 2024 Stock Tag Explorer. Êï∞ÊçÆÊù•Ê∫ê: Polygon.io & Finnhub | Êõ¥Êñ∞Êó∂Èó¥: <span id="last-update">--</span></p>
            </div>
        </footer>
        
        <!-- Toast ÈÄöÁü• -->
        <div id="toast" class="toast hidden"></div>
    </div>
    
    <script>
        // ÂÆûÊó∂Êó∂Èó¥ÊòæÁ§∫ÂäüËÉΩ
        function updateTime() {
            const now = new Date();
            
            // Êú¨Âú∞Êó∂Èó¥
            const localTime = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            
            // Áæé‰∏úÊó∂Èó¥
            const etTime = now.toLocaleString('en-US', {
                timeZone: 'America/New_York',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            
            document.getElementById('local-time').textContent = localTime;
            document.getElementById('et-time').textContent = `Áæé‰∏úÊó∂Èó¥: ${etTime}`;
            document.getElementById('last-update').textContent = localTime;
        }
        
        // ÊØèÁßíÊõ¥Êñ∞Êó∂Èó¥
        setInterval(updateTime, 1000);
        updateTime(); // Á´ãÂç≥ÊâßË°å‰∏ÄÊ¨°
        
        // Ê†áÁ≠æÂπøÂú∫Â∫îÁî®Á±ª
        class TagExplorerApp {
            constructor() {
                this.selectedTags = new Set();
                this.currentPage = 1;
                this.pageSize = 20;
                this.currentSort = 'name-asc';
                this.allStocks = [];
                this.filteredStocks = [];
                
                this.init();
            }
            
            init() {
                this.bindEvents();
                this.loadTagGroups();
            }
            
            bindEvents() {
                // ÊéíÂ∫èÈÄâÊã©
                document.getElementById('sort-select').addEventListener('change', (e) => {
                    this.currentSort = e.target.value;
                    this.sortAndDisplayStocks();
                });
                
                // Ê∏ÖÈô§ÈÄâÊã©
                document.getElementById('clear-selection').addEventListener('click', () => {
                    this.clearSelection();
                });
                
                // Ê†áÁ≠æÂç°ÁâáÁÇπÂáª
                document.addEventListener('click', (e) => {
                    if (e.target.closest('.tag-card')) {
                        const tagCard = e.target.closest('.tag-card');
                        const tagId = tagCard.dataset.tagId;
                        this.toggleTag(tagId, tagCard);
                    }
                });
            }
            
            async loadTagGroups() {
                try {
                    // Ê®°ÊãüAPIË∞ÉÁî® - ÂÆûÈôÖÂ∫îËØ•Ë∞ÉÁî®ÂêéÁ´ØAPI
                    const tagGroups = this.generateMockTagGroups();
                    this.renderTagGroups(tagGroups);
                    this.hideLoading();
                } catch (error) {
                    this.showError('Âä†ËΩΩÊ†áÁ≠æÂ§±Ë¥•ÔºåËØ∑Âà∑Êñ∞ÈáçËØï');
                    console.error('Failed to load tag groups:', error);
                }
            }
            
            generateMockTagGroups() {
                return [
                    {
                        id: 'performance',
                        name: 'ËÇ°Â∏ÇË°®Áé∞',
                        type: 'performance',
                        tags: [
                            { id: 'high_growth', name: 'È´òÂ¢ûÈïø', description: 'Ëê•Êî∂Â¢ûÈïøË∂ÖËøá20%', stockCount: 156 },
                            { id: 'dividend_kings', name: 'ËÇ°ÊÅØ‰πãÁéã', description: 'ËøûÁª≠25Âπ¥ÂàÜÁ∫¢', stockCount: 89 },
                            { id: 'momentum', name: 'Âä®ÈáèËÇ°', description: 'ËøëÊúüË°®Áé∞Âº∫Âä≤', stockCount: 234 },
                            { id: 'value_stocks', name: '‰ª∑ÂÄºËÇ°', description: '‰Ωé‰º∞ÂÄºÈ´òË¥®Èáè', stockCount: 178 }
                        ]
                    },
                    {
                        id: 'financial',
                        name: 'Ë¥¢Âä°ÊåáÊ†á',
                        type: 'financial',
                        tags: [
                            { id: 'low_pe', name: '‰ΩéÂ∏ÇÁõàÁéá', description: 'P/EÊØîÁéá‰Ωé‰∫é15', stockCount: 145 },
                            { id: 'high_roe', name: 'È´òROE', description: 'ÂáÄËµÑ‰∫ßÊî∂ÁõäÁéá>15%', stockCount: 123 },
                            { id: 'low_debt', name: '‰ΩéË¥üÂÄ∫', description: 'Ë¥üÂÄ∫Áéá‰Ωé‰∫é30%', stockCount: 167 },
                            { id: 'cash_rich', name: 'Áé∞ÈáëÂÖÖË£ï', description: 'Áé∞ÈáëÊµÅÂÖÖË∂≥', stockCount: 198 }
                        ]
                    },
                    {
                        id: 'trend',
                        name: 'Â∏ÇÂú∫Ë∂ãÂäø',
                        type: 'trend',
                        tags: [
                            { id: 'ai_revolution', name: 'AIÈù©ÂëΩ', description: '‰∫∫Â∑•Êô∫ËÉΩÁõ∏ÂÖ≥', stockCount: 87 },
                            { id: 'green_energy', name: 'ÁªøËâ≤ËÉΩÊ∫ê', description: 'Ê∏ÖÊ¥ÅËÉΩÊ∫êÊ¶ÇÂøµ', stockCount: 134 },
                            { id: 'cloud_computing', name: '‰∫ëËÆ°ÁÆó', description: '‰∫ëÊúçÂä°Êèê‰æõÂïÜ', stockCount: 76 },
                            { id: 'biotech', name: 'ÁîüÁâ©ÁßëÊäÄ', description: 'ÁîüÁâ©ÊäÄÊúØÂàõÊñ∞', stockCount: 112 }
                        ]
                    },
                    {
                        id: 'industry',
                        name: 'Ë°å‰∏öÂàÜÁ±ª',
                        type: 'industry',
                        tags: [
                            { id: 'tech_giants', name: 'ÁßëÊäÄÂ∑®Â§¥', description: 'Â§ßÂûãÁßëÊäÄÂÖ¨Âè∏', stockCount: 45 },
                            { id: 'healthcare', name: 'ÂåªÁñó‰øùÂÅ•', description: 'ÂåªÁñóÂÅ•Â∫∑Ë°å‰∏ö', stockCount: 189 },
                            { id: 'financial_services', name: 'ÈáëËûçÊúçÂä°', description: 'Èì∂Ë°å‰øùÈô©ËØÅÂà∏', stockCount: 156 },
                            { id: 'consumer_goods', name: 'Ê∂àË¥πÂìÅ', description: 'Êó•Áî®Ê∂àË¥πÂìÅ', stockCount: 234 }
                        ]
                    },
                    {
                        id: 'special',
                        name: 'ÁâπËâ≤Ê†áÁ≠æ',
                        type: 'special',
                        tags: [
                            { id: 'esg_leaders', name: 'ESGÈ¢ÜÂØºËÄÖ', description: 'ÁéØÂ¢ÉÁ§æ‰ºöÊ≤ªÁêÜ‰ºòÁßÄ', stockCount: 98 },
                            { id: 'insider_buying', name: 'ÂÜÖÈÉ®‰∫∫Â¢ûÊåÅ', description: 'ÁÆ°ÁêÜÂ±ÇÂ¢ûÊåÅËÇ°Á•®', stockCount: 67 },
                            { id: 'analyst_upgrades', name: 'ÂàÜÊûêÂ∏à‰∏äË∞É', description: 'ËøëÊúüË¢´‰∏äË∞ÉËØÑÁ∫ß', stockCount: 89 },
                            { id: 'earnings_beat', name: '‰∏öÁª©Ë∂ÖÈ¢ÑÊúü', description: 'Ë¥¢Êä•Ë∂ÖÂá∫È¢ÑÊúü', stockCount: 123 }
                        ]
                    }
                ];
            }
            
            renderTagGroups(tagGroups) {
                const container = document.getElementById('tag-groups');
                container.innerHTML = tagGroups.map(group => `
                    <div class="tag-group ${group.type}">
                        <h3>${group.name}</h3>
                        <div class="tag-cards">
                            ${group.tags.map(tag => `
                                <div class="tag-card" data-tag-id="${tag.id}">
                                    <h4>${tag.name}</h4>
                                    <p>${tag.description}</p>
                                    <div class="stock-count">${tag.stockCount} Âè™ËÇ°Á•®</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
                
                container.classList.remove('hidden');
            }
            
            async toggleTag(tagId, tagCard) {
                if (this.selectedTags.has(tagId)) {
                    this.selectedTags.delete(tagId);
                    tagCard.style.background = '';
                    tagCard.style.color = '';
                } else {
                    this.selectedTags.add(tagId);
                    tagCard.style.background = 'var(--primary-color)';
                    tagCard.style.color = 'white';
                }
                
                if (this.selectedTags.size > 0) {
                    await this.loadStocksByTags();
                } else {
                    this.hideStockList();
                }
            }
            
            async loadStocksByTags() {
                try {
                    this.showStockListLoading();
                    
                    // Ê®°ÊãüAPIË∞ÉÁî® - ÂÆûÈôÖÂ∫îËØ•Ë∞ÉÁî®ÂêéÁ´ØAPI
                    const stocks = this.generateMockStocks();
                    this.allStocks = stocks;
                    this.filteredStocks = stocks;
                    
                    this.updateStockListTitle();
                    this.sortAndDisplayStocks();
                    this.showStockList();
                } catch (error) {
                    this.showToast('Âä†ËΩΩËÇ°Á•®Êï∞ÊçÆÂ§±Ë¥•', 'error');
                    console.error('Failed to load stocks:', error);
                }
            }
            
            generateMockStocks() {
                const mockStocks = [
                    { symbol: 'AAPL', name: 'ËãπÊûúÂÖ¨Âè∏', price: 175.43, change: 5.67, changePercent: 3.34, volume: '45.2M' },
                    { symbol: 'MSFT', name: 'ÂæÆËΩØÂÖ¨Âè∏', price: 378.85, change: -2.15, changePercent: -0.56, volume: '28.1M' },
                    { symbol: 'GOOGL', name: 'Ë∞∑Ê≠åÊØçÂÖ¨Âè∏', price: 138.21, change: 8.92, changePercent: 6.90, volume: '32.5M' },
                    { symbol: 'AMZN', name: '‰∫öÈ©¨ÈÄäÂÖ¨Âè∏', price: 151.94, change: 4.23, changePercent: 2.86, volume: '41.8M' },
                    { symbol: 'TSLA', name: 'ÁâπÊñØÊãâÂÖ¨Âè∏', price: 248.50, change: -12.30, changePercent: -4.72, volume: '67.3M' },
                    { symbol: 'META', name: 'MetaÂπ≥Âè∞', price: 484.20, change: 15.67, changePercent: 3.35, volume: '19.4M' },
                    { symbol: 'NVDA', name: 'Ëã±‰ºüËææÂÖ¨Âè∏', price: 875.28, change: 45.82, changePercent: 5.52, volume: '52.1M' },
                    { symbol: 'NFLX', name: 'Â•àÈ£ûÂÖ¨Âè∏', price: 445.03, change: -8.97, changePercent: -1.98, volume: '15.7M' },
                    { symbol: 'JPM', name: 'Êë©Ê†πÂ§ßÈÄö', price: 168.45, change: 3.21, changePercent: 1.94, volume: '22.3M' },
                    { symbol: 'JNJ', name: 'Âº∫ÁîüÂÖ¨Âè∏', price: 159.87, change: -1.45, changePercent: -0.90, volume: '18.9M' }
                ];
                
                return mockStocks;
            }
            
            sortAndDisplayStocks() {
                const [field, direction] = this.currentSort.split('-');
                
                this.filteredStocks.sort((a, b) => {
                    let aVal, bVal;
                    
                    switch (field) {
                        case 'name':
                            aVal = a.name;
                            bVal = b.name;
                            break;
                        case 'price':
                            aVal = a.price;
                            bVal = b.price;
                            break;
                        case 'change':
                            aVal = a.changePercent;
                            bVal = b.changePercent;
                            break;
                        case 'volume':
                            aVal = parseFloat(a.volume.replace('M', ''));
                            bVal = parseFloat(b.volume.replace('M', ''));
                            break;
                        default:
                            aVal = a.symbol;
                            bVal = b.symbol;
                    }
                    
                    if (direction === 'asc') {
                        return aVal > bVal ? 1 : -1;
                    } else {
                        return aVal < bVal ? 1 : -1;
                    }
                });
                
                this.renderStockList();
            }
            
            renderStockList() {
                const container = document.getElementById('stock-list');
                const startIndex = (this.currentPage - 1) * this.pageSize;
                const endIndex = startIndex + this.pageSize;
                const pageStocks = this.filteredStocks.slice(startIndex, endIndex);
                
                container.innerHTML = pageStocks.map(stock => {
                    const changeClass = stock.change > 0 ? 'positive' : stock.change < 0 ? 'negative' : 'neutral';
                    const changeSymbol = stock.change > 0 ? '+' : '';
                    
                    return `
                        <div class="stock-item">
                            <div class="stock-info">
                                <div class="stock-symbol">${stock.symbol}</div>
                                <div class="stock-name">${stock.name}</div>
                            </div>
                            <div class="stock-metrics">
                                <div class="stock-price">$${stock.price.toFixed(2)}</div>
                                <div class="stock-change ${changeClass}">
                                    ${changeSymbol}${stock.changePercent.toFixed(2)}%
                                </div>
                                <div class="stock-volume">${stock.volume}</div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                this.renderPagination();
            }
            
            renderPagination() {
                const totalPages = Math.ceil(this.filteredStocks.length / this.pageSize);
                if (totalPages <= 1) {
                    document.getElementById('pagination').classList.add('hidden');
                    return;
                }
                
                const container = document.getElementById('pagination');
                let paginationHTML = '';
                
                // ‰∏ä‰∏ÄÈ°µ
                paginationHTML += `<button ${this.currentPage === 1 ? 'disabled' : ''} onclick="app.goToPage(${this.currentPage - 1})">‰∏ä‰∏ÄÈ°µ</button>`;
                
                // È°µÁ†Å
                for (let i = 1; i <= totalPages; i++) {
                    if (i === this.currentPage) {
                        paginationHTML += `<button class="active">${i}</button>`;
                    } else {
                        paginationHTML += `<button onclick="app.goToPage(${i})">${i}</button>`;
                    }
                }
                
                // ‰∏ã‰∏ÄÈ°µ
                paginationHTML += `<button ${this.currentPage === totalPages ? 'disabled' : ''} onclick="app.goToPage(${this.currentPage + 1})">‰∏ã‰∏ÄÈ°µ</button>`;
                
                container.innerHTML = paginationHTML;
                container.classList.remove('hidden');
            }
            
            goToPage(page) {
                const totalPages = Math.ceil(this.filteredStocks.length / this.pageSize);
                if (page < 1 || page > totalPages) return;
                
                this.currentPage = page;
                this.renderStockList();
            }
            
            updateStockListTitle() {
                const tagNames = Array.from(this.selectedTags).join(', ');
                document.getElementById('stock-list-title').textContent = `ÈÄâ‰∏≠Ê†áÁ≠æÁöÑËÇ°Á•® (${tagNames})`;
            }
            
            clearSelection() {
                this.selectedTags.clear();
                document.querySelectorAll('.tag-card').forEach(card => {
                    card.style.background = '';
                    card.style.color = '';
                });
                this.hideStockList();
            }
            
            showStockList() {
                document.getElementById('stock-list-section').classList.remove('hidden');
            }
            
            hideStockList() {
                document.getElementById('stock-list-section').classList.add('hidden');
            }
            
            showStockListLoading() {
                document.getElementById('stock-list').innerHTML = '<div class="loading">Âä†ËΩΩËÇ°Á•®Êï∞ÊçÆ‰∏≠...</div>';
                this.showStockList();
            }
            
            hideLoading() {
                document.getElementById('loading').classList.add('hidden');
            }
            
            showError(message) {
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('error').classList.remove('hidden');
                document.getElementById('error').textContent = message;
            }
            
            showToast(message, type = 'info') {
                const toast = document.getElementById('toast');
                toast.textContent = message;
                toast.className = `toast ${type}`;
                toast.classList.remove('hidden');
                
                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 3000);
            }
        }
        
        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñÂ∫îÁî®
        let app;
        document.addEventListener('DOMContentLoaded', () => {
            app = new TagExplorerApp();
        });
    </script>
</body>
</html>

